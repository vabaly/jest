# 快照测试学习笔记

快照测试的目的是保证每次渲染都是一模一样的，原理就是保存第一次测试用例运行时渲染的 HTML 字符串，后续测试则会与第一次保存的字符串进行比较，相等就代表测试成功了。

- [可以看看这个文件来认识快照文件长什么样子](../examples/snapshot/__tests__/__snapshots__/link.react.test.js.snap)
- [可以看看这个文件来看看测试用例该怎么写](../examples/snapshot/__tests__/link.react.test.js)

## 涉及的库

- 如果是生成 React 渲染的 HTML 字符串，则使用 `react-test-renderer` 库

## 更新快照文件

当运行测试用例时，加上 `--updateSnapshot` 参数，就会重新保存一份快照文件。

当测试用例比较多时，可以使用 `--watch` 参数来一个个选择是否更新。

## 匹配接口

- `.toMatchSnapshot`：会生成一个快照文件在同级的 `__snapshot__` 目录下面。
- `.toMatchInlineSnapshot`：直接修改测试文件，在这个方法里面加上 HTML 字符串作为参数。

## 有交互事件的各情况比对

如果要匹配在某种交互事件发生的场景下，每次的渲染情况是不是一致，就需要手动触发这个事件，例如使用 `react-test-renderer` 可以通过 `tree.props.onMouseEnter()` 触发鼠标进入的事件。

## 匹配的本质是字符串与字符串之间的匹配

- [可以看看这个例子](../examples/snapshot/__tests__/basic.test.js)
- 对象匹配可以给某些字段配置期望的值
